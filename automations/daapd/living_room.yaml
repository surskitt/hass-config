---
- id: muscovy_available_switch
  alias: switch to muscovy daapd when it is made available
  mode: queued

  trigger:
    - platform: state
      entity_id: media_player.forked_daapd_output_muscovy
      from: unavailable

  action:
    - service: media_player.turn_on
      entity_id: media_player.forked_daapd_output_muscovy

    - service: media_player.volume_set
      entity_id: media_player.forked_daapd_output_muscovy
      data:
        volume_level: 0.8

    - service: media_player.turn_off
      entity_id: media_player.forked_daapd_output_living_room_speaker

- id: muscovy_speaker_input_switch
  alias: switch edifier speaker input to muscovy when it is turned on
  mode: queued

  trigger:
    - platform: state
      entity_id: media_player.forked_daapd_output_muscovy
      to: 'on'

  condition:
    - condition: state
      entity_id: media_player.forked_daapd_server
      state: playing

  action:
    - service: remote.send_command
      data:
        device: edifier speakers
        command:
          - opt_coax
          - line1_2
          - line1_2
        delay_secs: 0.2
      target:
        entity_id: remote.broadlink_mini_remote

- id: muscovy_off_switch_back
  alias: switch back to living room speakers when vinyl switch is turned off
  mode: queued

  trigger:
    - platform: state
      entity_id: switch.vinyl
      to: 'off'

  action:
    - service: media_player.turn_on
      entity_id: media_player.forked_daapd_output_living_room_speaker
