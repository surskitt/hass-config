---
- id: plant_report
  alias: Give a report of plant status every morning
  mode: single

  trigger:
    - platform: time
      at:
        - input_datetime.alarm_clock
        - "12:00"
        - "17:00"

  action:
    - service: telegram_bot.send_message
      data:
        message: |
          {% set plants = expand('plant.ben', 'plant.eric', 'plant.ryu', 'plant.jaesuk', 'plant.gustaf', 'plant.beric', 'plant.paisley') -%}

          ğŸª´ Plant report ğŸŒ±
          {% for p in plants -%}

          {% set name = state_attr(p.entity_id, 'friendly_name')|title -%}
          {% set problem = state_attr(p.entity_id, 'problem') -%}

          {% if problem != 'none' -%}
          {% if 'moisture high' in problem -%}
          ğŸŒŠ {{ name }} has too much water
          {% elif 'moisture low' in problem -%}
          ğŸŒµ {{ name }} needs more water
          {% elif 'temperature high' in problem -%}
          ğŸ˜° {{ name }} is too hot
          {% elif 'temperature high' in problem -%}
          â˜ƒï¸ {{ name }} is too cold
          {% elif 'conductivity high' in problem -%}
          ğŸ’©{{ name }} has too much food
          {% elif 'conductivity low' in problem -%}
          ğŸ˜‹ {{ name }} needs food
          {% endif -%}
          {% else -%}
          ğŸ˜Š {{ name}} is fine
          {% endif %}
          {%- endfor %}
